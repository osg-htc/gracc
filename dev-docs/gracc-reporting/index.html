
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-7.1.0">
    
    
      
        <title>GRACC Reporting - GRACC Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.33e2939f.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ef6f36e2.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    <script>function __prefix(e){return new URL("../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#gracc-reporting" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="GRACC Documentation" class="md-header__button md-logo" aria-label="GRACC Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            GRACC Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              GRACC Reporting
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/osg-htc/gracc/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="GRACC Documentation" class="md-nav__button md-logo" aria-label="GRACC Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    GRACC Documentation
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/osg-htc/gracc/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Introduction
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      <label class="md-nav__link" for="__nav_2">
        User Guide
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="User Guide" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          User Guide
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../user/standard/" class="md-nav__link">
        Standard Interfaces
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../user/grafana/" class="md-nav__link">
        Custom Grafana
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../user/direct/" class="md-nav__link">
        Direct Queries
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      <label class="md-nav__link" for="__nav_3">
        Development Docs
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Development Docs" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Development Docs
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../agent-arch/" class="md-nav__link">
        Agent Architecture
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../message-queues/" class="md-nav__link">
        Message Queues
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../raw-records/" class="md-nav__link">
        Raw Records
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      <label class="md-nav__link" for="__nav_4">
        Operator Docs
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Operator Docs" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Operator Docs
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../install-grace-db/" class="md-nav__link">
        Installation
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../backups/" class="md-nav__link">
        Backup Documentation
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ops/services/" class="md-nav__link">
        Operations
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ops/troubleshoot/" class="md-nav__link">
        Troubleshooting
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      <label class="md-nav__link" for="__nav_5">
        Content Management
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Content Management" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Content Management
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../content/corrections/" class="md-nav__link">
        Corrections
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#reports-in-gracc-reporting" class="md-nav__link">
    Reports in gracc-reporting
  </a>
  
    <nav class="md-nav" aria-label="Reports in gracc-reporting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#source" class="md-nav__link">
    Source
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gracc-reporting-structure" class="md-nav__link">
    gracc-reporting structure
  </a>
  
    <nav class="md-nav" aria-label="gracc-reporting structure">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#general-report-structure" class="md-nav__link">
    General Report Structure
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#running-reports-in-development" class="md-nav__link">
    Running Reports in Development
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuration-files" class="md-nav__link">
    Configuration files
  </a>
  
    <nav class="md-nav" aria-label="Configuration files">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#future-deprecated-behavior" class="md-nav__link">
    Future deprecated behavior:
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#override-flags" class="md-nav__link">
    Override flags:
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installation" class="md-nav__link">
    Installation
  </a>
  
    <nav class="md-nav" aria-label="Installation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#setuptools" class="md-nav__link">
    Setuptools
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rpm-future" class="md-nav__link">
    RPM (future)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#addendum-more-detailed-developer-notes" class="md-nav__link">
    Addendum:  More detailed developer notes
  </a>
  
    <nav class="md-nav" aria-label="Addendum:  More detailed developer notes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#shared-libraries" class="md-nav__link">
    Shared Libraries
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#building-a-new-release" class="md-nav__link">
    Building a new release
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/osg-htc/gracc/edit/master/docs/dev-docs/gracc-reporting.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="gracc-reporting">GRACC Reporting</h1>
<p>gracc-reporting is a python package (python 2.7+) that consists of a standard set of reporting libraries, and individual report executables that query GRACC, aggregate the data, and send reports to various stakeholders.</p>
<p>A lot of this information has been pulled from (and updated since then) <a href="https://docs.google.com/presentation/d/1FPfBx8lmHGYwaM0RTrlZ1ANc2Osx1G_Utcs0o3xKwOI/edit?usp=sharing">this presentation</a>.</p>
<h2 id="reports-in-gracc-reporting">Reports in gracc-reporting</h2>
<p>There are currently three subpackages in gracc-reporting.  In the future, we plan to split these out from the main set of reporting libraries.  These packages are:</p>
<ul>
<li>OSG Reports<ul>
<li>OSG Flocking Report (osgflockingreport) - VO usage of OSG sites reported by flocking probes</li>
<li>OSG Project Usage Report (osgreport) - Project usage of OSG resources (OSG-Direct, OSG-Connect, XD)</li>
<li>OSG Missing Projects from Records Report (osgmissingprojects)</li>
<li>OSG VO Usage Per Site Report (osgpersitereport)</li>
<li>Top [N] Providers of Opportunistic Hours on the OSG (News Report) (osgtopoppusagereport)</li>
<li>Gratia Probes that haven't reported in the past two days (osgprobereport)</li>
</ul>
</li>
<li>FIFE Reports<ul>
<li>Job Success Rate Report (jobsuccessratereport)</li>
<li>User Efficiency Report (efficiencyreport)</li>
<li>Top Wasted Hours by Users by VO Report (topwastedhoursvoreport)</li>
</ul>
</li>
<li>Minerva Report (deprecated)</li>
</ul>
<h3 id="source">Source</h3>
<p>The source code for gracc-reporting is on the <a href="https://github.com/opensciencegrid/gracc-reporting">OSG's Github Page</a>.  The Dockerfiles are contained in that repository as well, but the deployment structure using docker is detailed on the <a href="../../ops/services/#configuring-gracc-reporting">Services</a> page.</p>
<h2 id="gracc-reporting-structure">gracc-reporting structure</h2>
<h3 id="general-report-structure">General Report Structure</h3>
<ul>
<li>Each report is subclass of ReportUtils.Reporter</li>
<li>Implemented methods in most reports:<ul>
<li>query: Define Elasticsearch query</li>
<li>ReportUtils.run_query:  Run that query and check for errors before proceeding</li>
<li>generate: Take results from query and parse them to generate raw data for any further processing</li>
<li>format_report (sometimes): Take processed data (sometimes from generate, sometimes from intermediate methods), put it into report format for TextUtils module to generate HTML, CSV, plain    text.</li>
<li>If this isn’t used, the formatting is done elsewhere in the report code.  For example, more complex HTML templates</li>
<li>send_report:  Email the report and check for errors</li>
<li>run_report: Run all of the above.  Mostly useful for more complex use cases (Probe Report, OSG Usage Per Site Report</li>
</ul>
</li>
</ul>
<h3 id="running-reports-in-development">Running Reports in Development</h3>
<ul>
<li>Each report has associated executable. </li>
<li>All can be used with -h, --help flag for full list of options</li>
<li>Generally, something like: <code>osgflockingreport -s “2016-11-09 06:00:00” -e “2016-11-16 06:00:00”</code></li>
<li>Notes:<ul>
<li>Almost all reports require a start time (-s) and end time (-e)</li>
<li>Times are assumed to be local time of host running reports.  The reports will convert to UTC to query GRACC.</li>
<li>Useful flags for all reports:<ul>
<li>-d: dryrun (email only goes to test_to_emails in config file)</li>
<li>-n: no email sent (unless there’s an error.  Then emails go to dryrun folks)</li>
<li>-v: verbose</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="configuration-files">Configuration files</h3>
<p>Configuration files are simple toml files that are read through the toml python module.  There is one for each subpackage.  In keeping with setuptools' philosophy, the config files and html templates that are shipped with the source code are kept within the package at <code>src/graccreports/{config|html_templates}</code>.  In each config file, the report sections correspond to a <code>ReportUtils.Reporter.report_type</code>.</p>
<h4 id="future-deprecated-behavior">Future deprecated behavior:</h4>
<p>Currently, the common reporting libraries (in this case, ReportUtils.py) automatically look for the config file in the following places (in order):
* Override (see <a href="#override-flags">below</a>)
* <code>/etc/gracc-reporting/{config|html_templates}</code>
* Within package using pkg_resources</p>
<p>The plan is to change this in the future to look for the config file in an override, an environment variable, and then within the package.  <code>/etc/gracc-reporting</code> might be kept if the deployment model is changed.</p>
<p>Similar to config files, the reports automatically try to write logs to the following locations:
* Override
* Specified in config file
* <code>/var/log/gracc-reporting</code>
* <code>$HOME/gracc-reporting</code>
* <code>/tmp/gracc-reporting</code></p>
<p>This will also be changed, so that the following order is observed:  override, environment variable, config file, <code>$HOME/gracc-reporting</code>.  In practice, the others are good, but unnecessary.</p>
<h3 id="override-flags">Override flags:</h3>
<ul>
<li>-c: Config file</li>
<li>-T: HTML Template</li>
<li>-L: logfile</li>
</ul>
<h2 id="installation">Installation</h2>
<h3 id="setuptools">Setuptools</h3>
<ul>
<li>Clone repository: <code>git clone https://github.com/opensciencegrid/gracc-reporting</code></li>
<li><code>pip install -r requirements.txt</code></li>
<li><code>python setup.py install</code></li>
</ul>
<p>After this is complete, remember to change the config files within the package (or wherever you copy them) as needed (email recipients, etc.)</p>
<h3 id="rpm-future">RPM (future)</h3>
<ul>
<li>RPM will be available online </li>
<li>Currently use this inside docker image</li>
<li>Config files, HTML templates, etc. installed at <code>/etc/gracc-reporting/</code></li>
<li>If you’re running RHEL7, CentOS7, SL7, etc., <a href="https://bugzilla.redhat.com/show_bug.cgi?id=1450213">bug</a> in package python-urllib3 in primary repo (RPM installation) - breaks python-elasticsearch </li>
<li>In my docker images, I uninstall python-urllib3, and pip install urllib3 to get around that (PyPI version is fine)</li>
</ul>
<h2 id="addendum-more-detailed-developer-notes">Addendum:  More detailed developer notes</h2>
<h3 id="shared-libraries">Shared Libraries</h3>
<ul>
<li>ReportUtils.py:  The big one<ul>
<li>Reporter class:<ul>
<li>Establish Elasticsearch client</li>
<li>Set correct ES index pattern (rather than just using <code>gracc.osg.raw-*</code>, unless we really want to query all raw records)</li>
<li>Run query with or without aggregations</li>
<li>Send simpler reports</li>
<li>Set up logging, get email info from config files, parse options to reports</li>
</ul>
</li>
<li>Also has functions to find config, HTML template files, as well as handle errors</li>
</ul>
</li>
<li>IndexPattern.py:  Figures out index pattern given a date range and flags.  Assumes <code>gracc.osg.summary</code> if there's no config file <code>index_pattern</code> flag for a given report.</li>
<li>TextUtils.py:  Used by ReportUtils to generate reports for simpler HTML templates</li>
<li>TimeUtils.py:  Datetime validation and time zone handling (built heavily off of datetime and dateutil, creates timestamps for grafana)</li>
</ul>
<h3 id="building-a-new-release">Building a new release</h3>
<ul>
<li>Implemented methods in most reports:</li>
<li>Edit setup.py if needed (if you have a new report, add executable, version update, etc.)</li>
<li><code>python setup.py sdist</code></li>
<li>Python package:<ul>
<li>Copy out the tarball in dist/ wherever you want to deploy, or push it to github and pull from there</li>
</ul>
</li>
<li>RPM:<ul>
<li>Spec file is in <code>config/</code> (symlink to <code>src/graccreports/config/</code>)</li>
</ul>
</li>
</ul>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Open Science Grid
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../../assets/javascripts/workers/search.fe42c31b.min.js", "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.d892486b.min.js"></script>
      
    
  </body>
</html>